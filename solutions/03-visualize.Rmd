---
title: "Visualization"
output: github_document
---

## Setup

The setup chunk always runs before anything else.

```{r setup}
# install.packages("tidyverse")
library(tidyverse)
```

## Warm up

Explore https://ggplot2.tidyverse.org/ and plot what you see in Usage.

```{r}
ggplot(mpg, aes(displ, hwy, colour = class)) +
  geom_point()
```

## Data

Copy-paste.

```{r}
# National Parks in California
ca <- read_csv("https://bit.ly/03-data-ca")
# Acadia National Park
acadia <- read_csv("https://bit.ly/03-data-acadia")
# Southeast US National Parks
se <- read_csv("https://bit.ly/03-data-se")
# 2016 Visitation for all Pacific West National Parks
visit_16 <- read_csv("https://bit.ly/03-data-visit-16")
# All Nationally designated sites in Massachusetts
mass <- read_csv("https://bit.ly/03-data-mass")
```

Preview the data with `View()` and `head()`.

```{r}
head(ca)
```

## Build

* Adapt the first example. Plot the data ca, with year on x and visitors on y.
* What relationship do you expect to see between year and the number of visitors?

```{r}
ggplot(data = ca, aes(x = year, y = visitors)) +
  geom_point()
```

* Now map the values of the variable `park_name` to the `color` aesthetics.

```{r}
ggplot(ca, aes(year, visitors, color = park_name)) +
  geom_point()
```

## Customizing

* https://ggplot2.tidyverse.org/reference/index.html#section-scales
* https://ggplot2.tidyverse.org/reference/index.html#section-themes

```{r}
ggplot(ca, aes(year, visitors, color = park_name)) +
  geom_point() +
  labs(title = "Acadia National Park Visitation", y = "Visitation", x = "Year") +
  theme_bw()
```

## Faceting

Now using data from Southeast US National Parks.

```{r}
ggplot(se, aes(year, visitors)) +
  geom_point() +
  facet_wrap(~ state)
```

## Geoms

### Discrete x

data = se

* Create a scatterplot of `park_name` (x) versus `visitors` (y).
* Is this a good plot?

```{r}
ggplot(data = se, aes(x = park_name, y = visitors)) + 
  geom_point()
```

* Create a jitter plot.

```{r}
ggplot(se, aes(park_name, visitors)) + 
  geom_jitter()
```

* Create a boxplot.

```{r}
ggplot(se, aes(x = park_name, y = visitors)) + 
  geom_boxplot()
```

### Time series

data = acadia

* Create a scatter plot
* Add lines
* Add a smoothed mean
* Move the smoothed mean to become the second layer. What subtle thing happened?

```{r}
ggplot(acadia, aes(year, visitors)) + 
  geom_point() +
  geom_line() +
  geom_smooth()
```

### Bar charts

data = visit_16

* Create a columns bar chart where the height of the columns represent `visotors` (y) per `state` (x).

```{r}
ggplot(visit_16, aes(state, visitors)) + 
  geom_col()
```

* Map the bar fill (color) to `park_name`.

```{r}
ggplot(visit_16, aes(state, visitors, fill = park_name)) + 
  geom_col()
```

### Position adjustments

* Now dodge the position of the bars to compare them side by side.

```{r}
ggplot(visit_16, aes(state, visitors, fill = park_name)) + 
  geom_col(position = "dodge")
```

* Dodge the bars to allow side by side comparison.

```{r}
ggplot(visit_16, aes(state, visitors, fill = park_name)) + 
  geom_col(position = "dodge")
```

## Arranging and exporting plots

data = mass

* Export the last plot with RStudio and `ggsave()`.

```{r}
my_plot <- ggplot(visit_16, aes(state, visitors, fill = park_name)) + 
  geom_col(position = "dodge")

ggsave(filename = "03-my_plot.pdf", my_plot)
```

### ggplotly

* Make your previous plot interactive with the function `ggplotly()` of the package plotly .

```{r}
library(plotly)
ggplotly(my_plot)
```



***

# Take aways

You can use this code template to make thousands of graphs with **ggplot2**.

```{r eval = FALSE}
ggplot(data = <DATA>) +
  <GEOM_FUNCTION>(mapping = aes(<MAPPINGS>))
```
